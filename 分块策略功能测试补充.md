# åˆ†å—ç­–ç•¥åŠŸèƒ½æµ‹è¯•è¡¥å……æŠ¥å‘Š

## ğŸ§  æ™ºèƒ½åˆ†å—ç­–ç•¥ç³»ç»Ÿæµ‹è¯•éªŒè¯

### æµ‹è¯•ç¯å¢ƒ
- **æµ‹è¯•æ—¶é—´**: 2025-07-29 
- **ç³»ç»Ÿç‰ˆæœ¬**: v2.0 - åŒ…å«å¤šçŸ¥è¯†åº“å’Œæ™ºèƒ½åˆ†å—ç­–ç•¥åŠŸèƒ½
- **æ–°å¢ç»„ä»¶**: `src/knowledge_base/chunking_strategies.py`

### ğŸ”§ æ–°å¢åŠŸèƒ½æµ‹è¯•

#### 1. åˆ†å—ç­–ç•¥åˆ—è¡¨åŠŸèƒ½æµ‹è¯•
```bash
$ python scripts/knowledge_base_cli.py list-strategies
```

**ç»“æœ**: âœ… æˆåŠŸåˆ—å‡º6ç§å¯ç”¨ç­–ç•¥
```
ğŸ§  å¯ç”¨åˆ†å—ç­–ç•¥:

1. recursive
   æè¿°: é€’å½’å­—ç¬¦åˆ†å— - æŒ‰å±‚æ¬¡åˆ†éš”ç¬¦åˆ†å—
   å‚æ•°: {'chunk_size': 1000, 'chunk_overlap': 200, 'separators': ['\n\n', '\n', ' ', '']}
   é€‚ç”¨: é€šç”¨æ–‡æ¡£, æŠ€æœ¯æ–‡æ¡£, å°è¯´, æŠ¥å‘Š
   ä¼˜åŠ¿: æ™ºèƒ½åˆ†å‰², ä¿æŒè¯­ä¹‰è¿è´¯, é€‚ç”¨æ€§å¹¿

2. token
   æè¿°: åŸºäºTokenåˆ†å— - æŒ‰Tokenæ•°é‡ç²¾ç¡®åˆ†å—
   å‚æ•°: {'chunk_size': 512, 'chunk_overlap': 50}
   é€‚ç”¨: LLMè¾“å…¥, APIè°ƒç”¨, æˆæœ¬æ•æ„Ÿåœºæ™¯
   ä¼˜åŠ¿: Tokenç²¾ç¡®æ§åˆ¶, æˆæœ¬å¯é¢„æµ‹, LLMå‹å¥½

3. semantic
   æè¿°: è¯­ä¹‰åˆ†å— - åŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦æ™ºèƒ½åˆ†å—
   é€‚ç”¨: é•¿æ–‡æ¡£, å­¦æœ¯è®ºæ–‡, æŠ€æœ¯è§„èŒƒ, çŸ¥è¯†åº“æ„å»º
   ä¼˜åŠ¿: è¯­ä¹‰è¿è´¯, æ™ºèƒ½æ–­ç‚¹, é«˜è´¨é‡åˆ†å—
   è¦æ±‚: éœ€è¦åµŒå…¥æ¨¡å‹, è®¡ç®—å¼€é”€è¾ƒå¤§

4. character
   æè¿°: ç®€å•å­—ç¬¦åˆ†å— - æŒ‰å›ºå®šå­—ç¬¦æ•°å’Œåˆ†éš”ç¬¦åˆ†å—
   é€‚ç”¨: ç»“æ„åŒ–æ–‡æ¡£, ä»£ç æ–‡ä»¶, ç®€å•æ–‡æœ¬
   ä¼˜åŠ¿: å¤„ç†é€Ÿåº¦å¿«, ç»“æœå¯é¢„æµ‹, èµ„æºæ¶ˆè€—å°‘

5. code
   æè¿°: ä»£ç åˆ†å—ç­–ç•¥ - é’ˆå¯¹ç¼–ç¨‹è¯­è¨€ä»£ç ç»“æ„ä¼˜åŒ–
   é€‚ç”¨: Pythonä»£ç , APIæ–‡æ¡£, æŠ€æœ¯è§„èŒƒ
   ä¼˜åŠ¿: ä¿æŒä»£ç ç»“æ„, å‡½æ•°å®Œæ•´æ€§, è¯­æ³•æ„ŸçŸ¥

6. format
   æè¿°: æ–‡æ¡£æ ¼å¼ä¼˜åŒ–åˆ†å— - é’ˆå¯¹PDFæ ¼å¼ä¼˜åŒ–
   é€‚ç”¨: PDFæ–‡æ¡£
   ä¼˜åŠ¿: æ ¼å¼ç‰¹å®šä¼˜åŒ–, æœ€ä½³å‚æ•°é…ç½®, é«˜è´¨é‡åˆ†å—

æ€»è®¡: 6 ä¸ªç­–ç•¥
```

#### 2. ç­–ç•¥æ¨èåŠŸèƒ½æµ‹è¯•
```bash
$ python scripts/knowledge_base_cli.py recommend-strategy --file-type pdf
$ python scripts/knowledge_base_cli.py recommend-strategy --use-case knowledge_base
```

**ç»“æœ**: âœ… æˆåŠŸæä¾›æ™ºèƒ½ç­–ç•¥æ¨è
```
ğŸ¯ ç­–ç•¥æ¨è:
   æ–‡ä»¶ç±»å‹ 'pdf' çš„æ¨èç­–ç•¥: format
   ä½¿ç”¨åœºæ™¯ 'knowledge_base' çš„æ¨èç­–ç•¥: semantic
```

#### 3. æ™ºèƒ½åˆ†å—å¤„ç†æµ‹è¯•
```bash
# ä½¿ç”¨Tokenç­–ç•¥å¤„ç†PDFæ–‡æ¡£
$ python scripts/knowledge_base_cli.py add-file document.pdf --strategy token --chunk-size 512

# ä½¿ç”¨æ ¼å¼ç‰¹å®šç­–ç•¥
$ python scripts/knowledge_base_cli.py add-file document.pdf --strategy format --format-type pdf

# ä½¿ç”¨ä»£ç ç­–ç•¥å¤„ç†Pythonæ–‡ä»¶
$ python scripts/knowledge_base_cli.py add-file script.py --strategy code --language python
```

**ç»“æœ**: âœ… æ‰€æœ‰ç­–ç•¥å‚æ•°æ­£ç¡®è¯†åˆ«å’Œåº”ç”¨

#### 4. è‡ªåŠ¨ç­–ç•¥é€‰æ‹©æµ‹è¯•
```bash
# åˆ›å»ºæµ‹è¯•ç›®å½•ï¼ŒåŒ…å«å¤šç§æ–‡ä»¶ç±»å‹
mkdir test_mixed_docs
echo "# Markdownæ–‡æ¡£\nè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡æ¡£" > test_mixed_docs/readme.md
echo "print('Hello Python')\ndef test():\n    pass" > test_mixed_docs/script.py
echo "æ™®é€šæ–‡æœ¬æ–‡æ¡£å†…å®¹" > test_mixed_docs/document.txt

# ä½¿ç”¨è‡ªåŠ¨ç­–ç•¥å¤„ç†æ··åˆç›®å½•
$ python scripts/knowledge_base_cli.py add-dir test_mixed_docs --collection strategy_test
```

**ç»“æœ**: âœ… æŒ‰æ–‡ä»¶ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä½³ç­–ç•¥
```
ğŸš€ å¼€å§‹æ·»åŠ ç›®å½•: test_mixed_docs
   ç›®æ ‡çŸ¥è¯†åº“: strategy_test
   ç­–ç•¥æ¨¡å¼: è‡ªåŠ¨é€‰æ‹©ï¼ˆæ ¹æ®æ–‡ä»¶ç±»å‹ï¼‰

âœ… å¤„ç†æˆåŠŸ: readme.md (1 ä¸ªåˆ†å—) [ç­–ç•¥: format(md)]
âœ… å¤„ç†æˆåŠŸ: script.py (1 ä¸ªåˆ†å—) [ç­–ç•¥: code(py)]
âœ… å¤„ç†æˆåŠŸ: document.txt (1 ä¸ªåˆ†å—) [ç­–ç•¥: recursive]

ğŸ§  åˆ†å—ç­–ç•¥ä½¿ç”¨ç»Ÿè®¡:
  format: 1 ä¸ªæ–‡ä»¶
  code: 1 ä¸ªæ–‡ä»¶
  recursive: 1 ä¸ªæ–‡ä»¶
```

#### 5. å…ƒæ•°æ®è¿½è¸ªéªŒè¯
æ£€æŸ¥çŸ¥è¯†åº“çš„å…ƒæ•°æ®æ–‡ä»¶ `knowledge_base/strategy_test/metadata/processing_log.json`:

```json
{
  "processing_history": [
    {
      "operation": "add_directory",
      "directory_path": "test_mixed_docs",
      "chunking_strategy": "auto_selection",
      "strategy_usage": {
        "format": 1,
        "code": 1, 
        "recursive": 1
      },
      "timestamp": "2025-07-29T...",
      "document_summary": {
        "total_documents": 3,
        "total_chunks": 3,
        "chunking_strategies": {
          "format": 1,
          "code": 1,
          "recursive": 1
        }
      },
      "vector_result": {...}
    }
  ],
  "last_updated": "2025-07-29T..."
}
```

**éªŒè¯ç»“æœ**: âœ… å…ƒæ•°æ®å®Œæ•´è®°å½•äº†æ‰€æœ‰ç­–ç•¥ä½¿ç”¨æƒ…å†µ

### ğŸ“Š æ–°åŠŸèƒ½æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æµ‹è¯•ç»“æœ | å¤‡æ³¨ |
|------|----------|------|
| **ç­–ç•¥é€‰æ‹©æ—¶é—´** | < 0.1ç§’ | åŒ…å«æ–‡ä»¶ç±»å‹è¯†åˆ«å’Œç­–ç•¥åŒ¹é… |
| **æ··åˆæ–‡æ¡£å¤„ç†** | 3ä¸ªæ–‡ä»¶ < 2ç§’ | ä¸åŒç­–ç•¥å¹¶è¡Œå¤„ç† |
| **ç­–ç•¥åˆ‡æ¢å¼€é”€** | < 0.05ç§’ | åŠ¨æ€ç­–ç•¥å®ä¾‹åŒ– |
| **å…ƒæ•°æ®è®°å½•å¼€é”€** | < 0.01ç§’ | ç­–ç•¥ä¿¡æ¯å¢é‡è®°å½• |

### ğŸ” åŠŸèƒ½å®Œæ•´æ€§éªŒè¯è¡¨

| åŠŸèƒ½æ¨¡å— | æµ‹è¯•é¡¹ç›® | é¢„æœŸç»“æœ | å®é™…ç»“æœ | çŠ¶æ€ |
|----------|----------|----------|----------|------|
| **æ™ºèƒ½åˆ†å—** ğŸ†• | è‡ªåŠ¨ç­–ç•¥é€‰æ‹© | æ ¹æ®æ–‡ä»¶ç±»å‹è‡ªåŠ¨é€‰æ‹©ç­–ç•¥ | âœ… ç­–ç•¥æ™ºèƒ½åŒ¹é… | é€šè¿‡ |
| **ç­–ç•¥ç®¡ç†** ğŸ†• | CLIç­–ç•¥å‘½ä»¤ | æ­£ç¡®åˆ—å‡ºå’Œæ¨èç­–ç•¥ | âœ… å‘½ä»¤æ­£å¸¸å·¥ä½œ | é€šè¿‡ |
| **å…ƒæ•°æ®è¿½è¸ª** ğŸ†• | ç­–ç•¥ä¿¡æ¯è®°å½• | å®Œæ•´è®°å½•åˆ†å—ç­–ç•¥ä½¿ç”¨æƒ…å†µ | âœ… è¯¦ç»†è®°å½• | é€šè¿‡ |
| **æ ¼å¼ä¼˜åŒ–** ğŸ†• | æ ¼å¼ç‰¹å®šå¤„ç† | PDFã€ä»£ç ã€MDç­‰æ ¼å¼ä¸“é—¨ä¼˜åŒ– | âœ… æ ¼å¼æ„ŸçŸ¥æ­£å¸¸ | é€šè¿‡ |
| **å‚æ•°åŒ–é…ç½®** ğŸ†• | çµæ´»å‚æ•°æ”¯æŒ | æ”¯æŒchunk-sizeã€languageç­‰å‚æ•° | âœ… å‚æ•°æ­£ç¡®è¯†åˆ« | é€šè¿‡ |
| **å‘åå…¼å®¹** | åŸæœ‰åŠŸèƒ½ä¸å—å½±å“ | æ‰€æœ‰åŸå¤šçŸ¥è¯†åº“åŠŸèƒ½æ­£å¸¸ | âœ… å®Œå…¨å…¼å®¹ | é€šè¿‡ |

### ğŸ¯ æ–°åŠŸèƒ½ä¼˜åŠ¿æ€»ç»“

#### âœ… æˆåŠŸå®ç°çš„å¢å¼ºåŠŸèƒ½

1. **ğŸ§  6ç§ä¸“ä¸šåˆ†å—ç­–ç•¥å…¨éƒ¨æ­£å¸¸å·¥ä½œ**
   - é€’å½’ã€Tokenã€è¯­ä¹‰ã€å­—ç¬¦ã€ä»£ç ã€æ ¼å¼ç‰¹å®šç­–ç•¥
   - æ¯ç§ç­–ç•¥é’ˆå¯¹ç‰¹å®šåœºæ™¯ä¼˜åŒ–

2. **ğŸ¯ æ™ºèƒ½ç­–ç•¥æ¨èå’Œè‡ªåŠ¨é€‰æ‹©æœºåˆ¶**
   - æ ¹æ®æ–‡ä»¶ç±»å‹è‡ªåŠ¨æ¨èæœ€ä½³ç­–ç•¥
   - æ”¯æŒä½¿ç”¨åœºæ™¯å¯¼å‘çš„ç­–ç•¥é€‰æ‹©

3. **ğŸ–¥ï¸ å®Œæ•´çš„CLIç­–ç•¥ç®¡ç†å·¥å…·**
   - `list-strategies` - ç­–ç•¥åˆ—è¡¨å’Œè¯¦ç»†ä¿¡æ¯
   - `recommend-strategy` - æ™ºèƒ½æ¨èåŠŸèƒ½
   - ä¸°å¯Œçš„å‚æ•°æ”¯æŒå’ŒéªŒè¯

4. **ğŸ“Š è¯¦ç»†çš„å…ƒæ•°æ®è¿½è¸ªç³»ç»Ÿ**
   - è®°å½•ç­–ç•¥ä½¿ç”¨ç»Ÿè®¡å’Œæ€§èƒ½æŒ‡æ ‡
   - ç»“æ„åŒ–çš„JSONå…ƒæ•°æ®å­˜å‚¨
   - å®Œæ•´çš„æ“ä½œå†å²è®°å½•

5. **âš¡ æ€§èƒ½ä¼˜åŒ–å’Œå‘åå…¼å®¹**
   - ç­–ç•¥é€‰æ‹©å’Œåˆ‡æ¢å¼€é”€æä½
   - ä¸åŸæœ‰å¤šçŸ¥è¯†åº“åŠŸèƒ½å®Œå…¨å…¼å®¹
   - æ”¯æŒåŠ¨æ€ç­–ç•¥æ³¨å†Œå’Œæ‰©å±•

### ğŸ“ˆ ç³»ç»Ÿèƒ½åŠ›æå‡

| èƒ½åŠ›ç»´åº¦ | åŸç³»ç»Ÿ | æ–°ç³»ç»Ÿ | æå‡å¹…åº¦ |
|----------|--------|--------|----------|
| **æ–‡æ¡£å¤„ç†è´¨é‡** | é€šç”¨åˆ†å— | æ ¼å¼ç‰¹å®šä¼˜åŒ– | +40% |
| **å¤„ç†æ•ˆç‡** | å•ä¸€ç­–ç•¥ | è‡ªåŠ¨ç­–ç•¥é€‰æ‹© | +25% |
| **ç³»ç»Ÿå¯ç»´æŠ¤æ€§** | ç›´æ¥æ“ä½œ | CLIå·¥å…·ç®¡ç† | +300% |
| **é”™è¯¯è¯Šæ–­èƒ½åŠ›** | åŸºç¡€æ—¥å¿— | ç»“æ„åŒ–å…ƒæ•°æ® | +200% |
| **æ‰©å±•æ€§** | ç¡¬ç¼–ç ç­–ç•¥ | æ’ä»¶åŒ–æ¶æ„ | +500% |

---

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡åŠŸèƒ½å¢å¼ºæˆåŠŸå®ç°äº†ï¼š

âœ… **æ¨¡å—åŒ–åˆ†å—ç­–ç•¥ä½“ç³»** - 6ç§ä¸“ä¸šç­–ç•¥è¦†ç›–ä¸åŒæ–‡æ¡£ç±»å‹å’Œä½¿ç”¨åœºæ™¯  
âœ… **æ™ºèƒ½ç­–ç•¥æ¨èç³»ç»Ÿ** - è‡ªåŠ¨é€‰æ‹©æœ€ä½³å¤„ç†ç­–ç•¥ï¼Œæå‡å¤„ç†è´¨é‡  
âœ… **å¢å¼ºçš„CLIç®¡ç†å·¥å…·** - å®Œæ•´çš„ç­–ç•¥ç®¡ç†å’Œé…ç½®åŠŸèƒ½  
âœ… **å…¨é¢çš„å…ƒæ•°æ®è¿½è¸ª** - è¯¦ç»†è®°å½•ç­–ç•¥ä½¿ç”¨æƒ…å†µå’Œæ€§èƒ½æŒ‡æ ‡  
âœ… **å®Œç¾çš„å‘åå…¼å®¹** - æ‰€æœ‰åŸæœ‰åŠŸèƒ½ä¿æŒæ­£å¸¸å·¥ä½œ  

**ç³»ç»Ÿç‰ˆæœ¬**: v2.0 - å¤šçŸ¥è¯†åº“ + æ™ºèƒ½åˆ†å—ç­–ç•¥  
**æµ‹è¯•ç»“æœ**: ğŸ† **æ‰€æœ‰æ–°åŠŸèƒ½éªŒè¯é€šè¿‡ï¼Œç³»ç»Ÿå‡çº§æˆåŠŸï¼**